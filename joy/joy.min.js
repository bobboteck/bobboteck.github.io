var JoyStick=function(t,e){function i(){S.beginPath(),S.arc(x,y,G,0,k,!1),S.lineWidth=w,S.strokeStyle=C,S.stroke()}function n(){S.beginPath(),m>Y&&(Y=E),Y+m>L.width&&(Y=L.width-E),m>T&&(T=E),T+m>L.height&&(T=L.height-E),S.arc(Y,T,m,0,k,!1);var t=S.createRadialGradient(x,y,5,x,y,200);t.addColorStop(0,f),t.addColorStop(1,g),S.fillStyle=t,S.fill(),S.lineWidth=v,S.strokeStyle=g,S.stroke()}function o(){W=1}function h(t){t.preventDefault(),1==W&&(Y=t.touches[0].pageX,T=t.touches[0].pageY,Y-=L.offsetLeft,T-=L.offsetTop,S.clearRect(0,0,L.width,L.height),i(),n())}function r(){W=0,Y=x,T=y,S.clearRect(0,0,L.width,L.height),i(),n()}function d(){W=1}function a(t){1==W&&(Y=t.pageX,T=t.pageY,Y-=L.offsetLeft,T-=L.offsetTop,S.clearRect(0,0,L.width,L.height),i(),n())}function l(){W=0,Y=x,T=y,S.clearRect(0,0,L.width,L.height),i(),n()}e=e||{};var c=void 0===e.title?"joystick":e.title,u=void 0===e.width?0:e.width,s=void 0===e.height?0:e.height,f=void 0===e.internalFillColor?"#00AA00":e.internalFillColor,v=void 0===e.internalLineWidth?2:e.internalLineWidth,g=void 0===e.internalStrokeColor?"#003300":e.internalStrokeColor,w=void 0===e.externalLineWidth?2:e.externalLineWidth,C=void 0===e.externalStrokeColor?"#008000":e.externalStrokeColor,p=document.getElementById(t),L=document.createElement("canvas");L.id=c,0==u&&(u=p.clientWidth),0==s&&(s=p.clientHeight),L.width=u,L.height=s,p.appendChild(L);var S=L.getContext("2d"),W=0,k=2*Math.PI,m=(L.width-110)/2,E=m+5,G=m+30,x=L.width/2,y=L.height/2,P=L.width/10,R=-1*P,F=L.height/10,X=-1*F,Y=x,T=y,b="createTouch"in document;b?(L.addEventListener("touchstart",o,!1),L.addEventListener("touchmove",h,!1),L.addEventListener("touchend",r,!1)):(L.addEventListener("mousedown",d,!1),L.addEventListener("mousemove",a,!1),L.addEventListener("mouseup",l,!1)),i(),n(x,y),this.GetWidth=function(){return L.width},this.GetHeight=function(){return L.height},this.GetPosX=function(){return Y},this.GetPosY=function(){return T},this.GetX=function(){return(100*((Y-x)/E)).toFixed()},this.GetY=function(){return(100*((T-y)/E)*-1).toFixed()},this.GetDir=function(){var t="",e=Y-x,i=T-y;return i>=X&&F>=i&&(t="C"),X>i&&(t="N"),i>F&&(t="S"),R>e&&("C"==t?t="W":t+="W"),e>P&&("C"==t?t="W":t+="E"),t}};